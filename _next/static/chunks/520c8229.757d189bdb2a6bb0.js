"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[509],{5865:function(e,t,n){n.d(t,{Cf:function(){return tg},Jo:function(){return eH},K9:function(){return tx},ML:function(){return th},NB:function(){return tk},Nl:function(){return f},P1:function(){return y},QC:function(){return eJ},S0:function(){return tv},XP:function(){return eF},b5:function(){return eV},eE:function(){return ek},hj:function(){return I},nU:function(){return w},tI:function(){return eG},u9:function(){return eW},vc:function(){return tw},x2:function(){return ty},zK:function(){return tb}});var r=n(2376),o=n(84348),i=n(82696),s=n(12806),a=n(16560),l=n(25804),d=n(53833);function c(e){let{state:t,transaction:n}=e,{selection:r}=n,{doc:o}=n,{storedMarks:i}=n;return{...t,apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),filterTransaction:t.filterTransaction,plugins:t.plugins,schema:t.schema,reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return i},get selection(){return r},get doc(){return o},get tr(){return r=n.selection,o=n.doc,i=n.storedMarks,n}}}class u{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){let{rawCommands:e,editor:t,state:n}=this,{view:r}=t,{tr:o}=n,i=this.buildProps(o);return Object.fromEntries(Object.entries(e).map(([e,t])=>{let n=(...e)=>{let n=t(...e)(i);return o.getMeta("preventDispatch")||this.hasCustomState||r.dispatch(o),n};return[e,n]}))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,t=!0){let{rawCommands:n,editor:r,state:o}=this,{view:i}=r,s=[],a=!!e,l=e||o.tr,d=()=>(a||!t||l.getMeta("preventDispatch")||this.hasCustomState||i.dispatch(l),s.every(e=>!0===e)),c={...Object.fromEntries(Object.entries(n).map(([e,n])=>{let r=(...e)=>{let r=this.buildProps(l,t),o=n(...e)(r);return s.push(o),c};return[e,r]})),run:d};return c}createCan(e){let{rawCommands:t,state:n}=this,r=e||n.tr,o=this.buildProps(r,!1),i=Object.fromEntries(Object.entries(t).map(([e,t])=>[e,(...e)=>t(...e)({...o,dispatch:void 0})]));return{...i,chain:()=>this.createChain(r,!1)}}buildProps(e,t=!0){let{rawCommands:n,editor:r,state:o}=this,{view:i}=r,s={tr:e,editor:r,view:i,state:c({state:o,transaction:e}),dispatch:t?()=>void 0:void 0,chain:()=>this.createChain(e,t),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(n).map(([e,t])=>[e,(...e)=>t(...e)(s)]))}};return s}}class p{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e,...t){let n=this.callbacks[e];return n&&n.forEach(e=>e.apply(this,t)),this}off(e,t){let n=this.callbacks[e];return n&&(t?this.callbacks[e]=n.filter(e=>e!==t):delete this.callbacks[e]),this}removeAllListeners(){this.callbacks={}}}function f(e,t,n){if(void 0===e.config[t]&&e.parent)return f(e.parent,t,n);if("function"==typeof e.config[t]){let r=e.config[t].bind({...n,parent:e.parent?f(e.parent,t,n):null});return r}return e.config[t]}function m(e){let t=e.filter(e=>"extension"===e.type),n=e.filter(e=>"node"===e.type),r=e.filter(e=>"mark"===e.type);return{baseExtensions:t,nodeExtensions:n,markExtensions:r}}function h(e){let t=[],{nodeExtensions:n,markExtensions:r}=m(e),o=[...n,...r],i={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return e.forEach(e=>{let n={name:e.name,options:e.options,storage:e.storage},r=f(e,"addGlobalAttributes",n);if(!r)return;let o=r();o.forEach(e=>{e.types.forEach(n=>{Object.entries(e.attributes).forEach(([e,r])=>{t.push({type:n,name:e,attribute:{...i,...r}})})})})}),o.forEach(e=>{let n={name:e.name,options:e.options,storage:e.storage},r=f(e,"addAttributes",n);if(!r)return;let o=r();Object.entries(o).forEach(([n,r])=>{let o={...i,...r};"function"==typeof(null==o?void 0:o.default)&&(o.default=o.default()),(null==o?void 0:o.isRequired)&&(null==o?void 0:o.default)===void 0&&delete o.default,t.push({type:e.name,name:n,attribute:o})})}),t}function g(e,t){if("string"==typeof e){if(!t.nodes[e])throw Error(`There is no node type named '${e}'. Maybe you forgot to add the extension?`);return t.nodes[e]}return e}function y(...e){return e.filter(e=>!!e).reduce((e,t)=>{let n={...e};return Object.entries(t).forEach(([e,t])=>{let r=n[e];if(!r){n[e]=t;return}if("class"===e){let o=t?t.split(" "):[],i=n[e]?n[e].split(" "):[],s=o.filter(e=>!i.includes(e));n[e]=[...i,...s].join(" ")}else"style"===e?n[e]=[n[e],t].join("; "):n[e]=t}),n},{})}function b(e,t){return t.filter(e=>e.attribute.rendered).map(t=>t.attribute.renderHTML?t.attribute.renderHTML(e.attrs)||{}:{[t.name]:e.attrs[t.name]}).reduce((e,t)=>y(e,t),{})}function v(e){return"function"==typeof e}function w(e,t,...n){return v(e)?t?e.bind(t)(...n):e(...n):e}function k(e,t){return e.style?e:{...e,getAttrs:n=>{let r=e.getAttrs?e.getAttrs(n):e.attrs;if(!1===r)return!1;let o=t.reduce((e,t)=>{var r;let o=t.attribute.parseHTML?t.attribute.parseHTML(n):"string"!=typeof(r=n.getAttribute(t.name))?r:r.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(r):"true"===r||"false"!==r&&r;return null==o?e:{...e,[t.name]:o}},{});return{...r,...o}}}}function x(e){return Object.fromEntries(Object.entries(e).filter(([e,t])=>!("attrs"===e&&function(e={}){return 0===Object.keys(e).length&&e.constructor===Object}(t))&&null!=t))}function M(e,t){return t.nodes[e]||t.marks[e]||null}function S(e,t){return Array.isArray(t)?t.some(t=>{let n="string"==typeof t?t:t.name;return n===e.name}):t}let O=(e,t=500)=>{let n="",r=e.parentOffset;return e.parent.nodesBetween(Math.max(0,r-t),r,(e,t,o,i)=>{var s,a;let l=(null===(a=(s=e.type.spec).toText)||void 0===a?void 0:a.call(s,{node:e,pos:t,parent:o,index:i}))||e.textContent||"%leaf%";n+=l.slice(0,Math.max(0,r-t))}),n};function E(e){return"[object RegExp]"===Object.prototype.toString.call(e)}class C{constructor(e){this.find=e.find,this.handler=e.handler}}let T=(e,t)=>{if(E(t))return t.exec(e);let n=t(e);if(!n)return null;let r=[n.text];return r.index=n.index,r.input=e,r.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(n.replaceWith)),r};function A(e){var t;let{editor:n,from:r,to:o,text:i,rules:s,plugin:a}=e,{view:l}=n;if(l.composing)return!1;let d=l.state.doc.resolve(r);if(d.parent.type.spec.code||(null===(t=d.nodeBefore||d.nodeAfter)||void 0===t?void 0:t.marks.find(e=>e.type.spec.code)))return!1;let p=!1,f=O(d)+i;return s.forEach(e=>{if(p)return;let t=T(f,e.find);if(!t)return;let s=l.state.tr,d=c({state:l.state,transaction:s}),m={from:r-(t[0].length-i.length),to:o},{commands:h,chain:g,can:y}=new u({editor:n,state:d}),b=e.handler({state:d,range:m,match:t,commands:h,chain:g,can:y});null!==b&&s.steps.length&&(s.setMeta(a,{transform:s,from:r,to:o,text:i}),l.dispatch(s),p=!0)}),p}class P{constructor(e){this.find=e.find,this.handler=e.handler}}let j=(e,t,n)=>{if(E(t))return[...e.matchAll(t)];let r=t(e,n);return r?r.map(t=>{let n=[t.text];return n.index=t.index,n.input=e,n.data=t.data,t.replaceWith&&(t.text.includes(t.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),n.push(t.replaceWith)),n}):[]};class N{constructor(e,t){this.splittableMarks=[],this.editor=t,this.extensions=N.resolve(e),this.schema=function(e,t){var n;let r=h(e),{nodeExtensions:o,markExtensions:i}=m(e),a=null===(n=o.find(e=>f(e,"topNode")))||void 0===n?void 0:n.name,l=Object.fromEntries(o.map(n=>{let o=r.filter(e=>e.type===n.name),i={name:n.name,options:n.options,storage:n.storage,editor:t},s=e.reduce((e,t)=>{let r=f(t,"extendNodeSchema",i);return{...e,...r?r(n):{}}},{}),a=x({...s,content:w(f(n,"content",i)),marks:w(f(n,"marks",i)),group:w(f(n,"group",i)),inline:w(f(n,"inline",i)),atom:w(f(n,"atom",i)),selectable:w(f(n,"selectable",i)),draggable:w(f(n,"draggable",i)),code:w(f(n,"code",i)),defining:w(f(n,"defining",i)),isolating:w(f(n,"isolating",i)),attrs:Object.fromEntries(o.map(e=>{var t;return[e.name,{default:null===(t=null==e?void 0:e.attribute)||void 0===t?void 0:t.default}]}))}),l=w(f(n,"parseHTML",i));l&&(a.parseDOM=l.map(e=>k(e,o)));let d=f(n,"renderHTML",i);d&&(a.toDOM=e=>d({node:e,HTMLAttributes:b(e,o)}));let c=f(n,"renderText",i);return c&&(a.toText=c),[n.name,a]})),d=Object.fromEntries(i.map(n=>{let o=r.filter(e=>e.type===n.name),i={name:n.name,options:n.options,storage:n.storage,editor:t},s=e.reduce((e,t)=>{let r=f(t,"extendMarkSchema",i);return{...e,...r?r(n):{}}},{}),a=x({...s,inclusive:w(f(n,"inclusive",i)),excludes:w(f(n,"excludes",i)),group:w(f(n,"group",i)),spanning:w(f(n,"spanning",i)),code:w(f(n,"code",i)),attrs:Object.fromEntries(o.map(e=>{var t;return[e.name,{default:null===(t=null==e?void 0:e.attribute)||void 0===t?void 0:t.default}]}))}),l=w(f(n,"parseHTML",i));l&&(a.parseDOM=l.map(e=>k(e,o)));let d=f(n,"renderHTML",i);return d&&(a.toDOM=e=>d({mark:e,HTMLAttributes:b(e,o)})),[n.name,a]}));return new s.V_({topNode:a,nodes:l,marks:d})}(this.extensions,t),this.extensions.forEach(e=>{var t;this.editor.extensionStorage[e.name]=e.storage;let n={name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:M(e.name,this.schema)};if("mark"===e.type){let r=null===(t=w(f(e,"keepOnSplit",n)))||void 0===t||t;r&&this.splittableMarks.push(e.name)}let o=f(e,"onBeforeCreate",n);o&&this.editor.on("beforeCreate",o);let i=f(e,"onCreate",n);i&&this.editor.on("create",i);let s=f(e,"onUpdate",n);s&&this.editor.on("update",s);let a=f(e,"onSelectionUpdate",n);a&&this.editor.on("selectionUpdate",a);let l=f(e,"onTransaction",n);l&&this.editor.on("transaction",l);let d=f(e,"onFocus",n);d&&this.editor.on("focus",d);let c=f(e,"onBlur",n);c&&this.editor.on("blur",c);let u=f(e,"onDestroy",n);u&&this.editor.on("destroy",u)})}static resolve(e){let t=N.sort(N.flatten(e)),n=function(e){let t=e.filter((t,n)=>e.indexOf(t)!==n);return[...new Set(t)]}(t.map(e=>e.name));return n.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${n.map(e=>`'${e}'`).join(", ")}]. This can lead to issues.`),t}static flatten(e){return e.map(e=>{let t={name:e.name,options:e.options,storage:e.storage},n=f(e,"addExtensions",t);return n?[e,...this.flatten(n())]:e}).flat(10)}static sort(e){return e.sort((e,t)=>{let n=f(e,"priority")||100,r=f(t,"priority")||100;return n>r?-1:n<r?1:0})}get commands(){return this.extensions.reduce((e,t)=>{let n={name:t.name,options:t.options,storage:t.storage,editor:this.editor,type:M(t.name,this.schema)},r=f(t,"addCommands",n);return r?{...e,...r()}:e},{})}get plugins(){let{editor:e}=this,t=N.sort([...this.extensions].reverse()),n=[],o=[],s=t.map(t=>{let r={name:t.name,options:t.options,storage:t.storage,editor:e,type:M(t.name,this.schema)},s=[],a=f(t,"addKeyboardShortcuts",r),l={};if("mark"===t.type&&t.config.exitable&&(l.ArrowRight=()=>tw.handleExit({editor:e,mark:t})),a){let d=Object.fromEntries(Object.entries(a()).map(([t,n])=>[t,()=>n({editor:e})]));l={...l,...d}}let c=(0,i.h)(l);s.push(c);let u=f(t,"addInputRules",r);S(t,e.options.enableInputRules)&&u&&n.push(...u());let p=f(t,"addPasteRules",r);S(t,e.options.enablePasteRules)&&p&&o.push(...p());let m=f(t,"addProseMirrorPlugins",r);if(m){let h=m();s.push(...h)}return s}).flat();return[function(e){let{editor:t,rules:n}=e,o=new r.Sy({state:{init:()=>null,apply(e,t){let n=e.getMeta(o);return n||(e.selectionSet||e.docChanged?null:t)}},props:{handleTextInput:(e,r,i,s)=>A({editor:t,from:r,to:i,text:s,rules:n,plugin:o}),handleDOMEvents:{compositionend:e=>(setTimeout(()=>{let{$cursor:r}=e.state.selection;r&&A({editor:t,from:r.pos,to:r.pos,text:"",rules:n,plugin:o})}),!1)},handleKeyDown(e,r){if("Enter"!==r.key)return!1;let{$cursor:i}=e.state.selection;return!!i&&A({editor:t,from:i.pos,to:i.pos,text:"\n",rules:n,plugin:o})}},isInputRules:!0});return o}({editor:e,rules:n}),...function(e){let{editor:t,rules:n}=e,o=null,i=!1,s=!1,a=new ClipboardEvent("paste"),l=new DragEvent("drop"),d=n.map(e=>new r.Sy({view(e){let t=t=>{var n;o=(null===(n=e.dom.parentElement)||void 0===n?void 0:n.contains(t.target))?e.dom.parentElement:null};return window.addEventListener("dragstart",t),{destroy(){window.removeEventListener("dragstart",t)}}},props:{handleDOMEvents:{drop:(e,t)=>(s=o===e.dom.parentElement,l=t,!1),paste:(e,t)=>{var n;let r=null===(n=t.clipboardData)||void 0===n?void 0:n.getData("text/html");return a=t,i=!!(null==r?void 0:r.includes("data-pm-slice")),!1}}},appendTransaction:(n,r,o)=>{let d=n[0],p="paste"===d.getMeta("uiEvent")&&!i,f="drop"===d.getMeta("uiEvent")&&!s;if(!p&&!f)return;let m=r.doc.content.findDiffStart(o.doc.content),h=r.doc.content.findDiffEnd(o.doc.content);if("number"!=typeof m||!h||m===h.b)return;let g=o.tr,y=c({state:o,transaction:g}),b=function(e){let{editor:t,state:n,from:r,to:o,rule:i,pasteEvent:s,dropEvent:a}=e,{commands:l,chain:d,can:c}=new u({editor:t,state:n}),p=[];n.doc.nodesBetween(r,o,(e,t)=>{if(!e.isTextblock||e.type.spec.code)return;let u=Math.max(r,t),f=Math.min(o,t+e.content.size),m=e.textBetween(u-t,f-t,void 0,"￼"),h=j(m,i.find,s);h.forEach(e=>{if(void 0===e.index)return;let t=u+e.index+1,r=t+e[0].length,o={from:n.tr.mapping.map(t),to:n.tr.mapping.map(r)},f=i.handler({state:n,range:o,match:e,commands:l,chain:d,can:c,pasteEvent:s,dropEvent:a});p.push(f)})});let f=p.every(e=>null!==e);return f}({editor:t,state:y,from:Math.max(m-1,0),to:h.b-1,rule:e,pasteEvent:a,dropEvent:l});if(b&&g.steps.length)return l=new DragEvent("drop"),a=new ClipboardEvent("paste"),g}}));return d}({editor:e,rules:o}),...s]}get attributes(){return h(this.extensions)}get nodeViews(){let{editor:e}=this,{nodeExtensions:t}=m(this.extensions);return Object.fromEntries(t.filter(e=>!!f(e,"addNodeView")).map(t=>{let n=this.attributes.filter(e=>e.type===t.name),r={name:t.name,options:t.options,storage:t.storage,editor:e,type:g(t.name,this.schema)},o=f(t,"addNodeView",r);if(!o)return[];let i=(r,i,s,a)=>{let l=b(r,n);return o()({editor:e,node:r,getPos:s,decorations:a,HTMLAttributes:l,extension:t})};return[t.name,i]}))}}function B(e){return"Object"===Object.prototype.toString.call(e).slice(8,-1)&&e.constructor===Object&&Object.getPrototypeOf(e)===Object.prototype}function $(e,t){let n={...e};return B(e)&&B(t)&&Object.keys(t).forEach(r=>{B(t[r])&&r in e?n[r]=$(e[r],t[r]):Object.assign(n,{[r]:t[r]})}),n}class I{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=w(f(this,"addOptions",{name:this.name}))),this.storage=w(f(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new I(e)}configure(e={}){let t=this.extend();return t.options=$(this.options,e),t.storage=w(f(t,"addStorage",{name:t.name,options:t.options})),t}extend(e={}){let t=new I(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=w(f(t,"addOptions",{name:t.name})),t.storage=w(f(t,"addStorage",{name:t.name,options:t.options})),t}}function R(e,t,n){let{from:r,to:o}=t,{blockSeparator:i="\n\n",textSerializers:s={}}=n||{},a="",l=!0;return e.nodesBetween(r,o,(e,n,d,c)=>{var u;let p=null==s?void 0:s[e.type.name];p?(e.isBlock&&!l&&(a+=i,l=!0),d&&(a+=p({node:e,pos:n,parent:d,index:c,range:t}))):e.isText?(a+=null===(u=null==e?void 0:e.text)||void 0===u?void 0:u.slice(Math.max(r,n)-n,o-n),l=!1):e.isBlock&&!l&&(a+=i,l=!0)}),a}function D(e){return Object.fromEntries(Object.entries(e.nodes).filter(([,e])=>e.spec.toText).map(([e,t])=>[e,t.spec.toText]))}let z=I.create({name:"clipboardTextSerializer",addProseMirrorPlugins(){return[new r.Sy({key:new r.H$("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{let{editor:e}=this,{state:t,schema:n}=e,{doc:r,selection:o}=t,{ranges:i}=o,s=Math.min(...i.map(e=>e.$from.pos)),a=Math.max(...i.map(e=>e.$to.pos)),l=D(n);return R(r,{from:s,to:a},{textSerializers:l})}}})]}}),L=()=>({editor:e,view:t})=>(requestAnimationFrame(()=>{var n;e.isDestroyed||(t.dom.blur(),null===(n=null==window?void 0:window.getSelection())||void 0===n||n.removeAllRanges())}),!0),H=(e=!1)=>({commands:t})=>t.setContent("",e),F=()=>({state:e,tr:t,dispatch:n})=>{let{selection:r}=t,{ranges:o}=r;return!n||(o.forEach(({$from:n,$to:r})=>{e.doc.nodesBetween(n.pos,r.pos,(e,n)=>{if(e.type.isText)return;let{doc:r,mapping:o}=t,i=r.resolve(o.map(n)),s=r.resolve(o.map(n+e.nodeSize)),l=i.blockRange(s);if(!l)return;let d=(0,a.k9)(l);if(e.type.isTextblock){let{defaultType:c}=i.parent.contentMatchAt(i.index());t.setNodeMarkup(l.start,c)}(d||0===d)&&t.lift(l,d)})}),!0)},V=e=>t=>e(t),K=()=>({state:e,dispatch:t})=>(0,l.mD)(e,t),W=(e,t)=>({editor:n,tr:o})=>{let{state:i}=n,s=i.doc.slice(e.from,e.to);o.deleteRange(e.from,e.to);let a=o.mapping.map(t);return o.insert(a,s.content),o.setSelection(new r.Bs(o.doc.resolve(a-1))),!0},J=()=>({tr:e,dispatch:t})=>{let{selection:n}=e,r=n.$anchor.node();if(r.content.size>0)return!1;let o=e.selection.$anchor;for(let i=o.depth;i>0;i-=1){let s=o.node(i);if(s.type===r.type){if(t){let a=o.before(i),l=o.after(i);e.delete(a,l).scrollIntoView()}return!0}}return!1},G=e=>({tr:t,state:n,dispatch:r})=>{let o=g(e,n.schema),i=t.selection.$anchor;for(let s=i.depth;s>0;s-=1){let a=i.node(s);if(a.type===o){if(r){let l=i.before(s),d=i.after(s);t.delete(l,d).scrollIntoView()}return!0}}return!1},U=e=>({tr:t,dispatch:n})=>{let{from:r,to:o}=e;return n&&t.delete(r,o),!0},_=()=>({state:e,dispatch:t})=>(0,l.NE)(e,t),q=()=>({commands:e})=>e.keyboardShortcut("Enter"),Y=()=>({state:e,dispatch:t})=>(0,l.uo)(e,t);function Q(e,t,n={strict:!0}){let r=Object.keys(t);return!r.length||r.every(r=>n.strict?t[r]===e[r]:E(t[r])?t[r].test(e[r]):t[r]===e[r])}function X(e,t,n={}){return e.find(e=>e.type===t&&Q(e.attrs,n))}function Z(e,t,n={}){if(!e||!t)return;let r=e.parent.childAfter(e.parentOffset);if(e.parentOffset===r.offset&&0!==r.offset&&(r=e.parent.childBefore(e.parentOffset)),!r.node)return;let o=X([...r.node.marks],t,n);if(!o)return;let i=r.index,s=e.start()+r.offset,a=i+1,l=s+r.node.nodeSize;for(X([...r.node.marks],t,n);i>0&&o.isInSet(e.parent.child(i-1).marks);)i-=1,s-=e.parent.child(i).nodeSize;for(;a<e.parent.childCount&&function(e,t,n={}){return!!X(e,t,n)}([...e.parent.child(a).marks],t,n);)l+=e.parent.child(a).nodeSize,a+=1;return{from:s,to:l}}function ee(e,t){if("string"==typeof e){if(!t.marks[e])throw Error(`There is no mark type named '${e}'. Maybe you forgot to add the extension?`);return t.marks[e]}return e}let et=(e,t={})=>({tr:n,state:o,dispatch:i})=>{let s=ee(e,o.schema),{doc:a,selection:l}=n,{$from:d,from:c,to:u}=l;if(i){let p=Z(d,s,t);if(p&&p.from<=c&&p.to>=u){let f=r.Bs.create(a,p.from,p.to);n.setSelection(f)}}return!0},en=e=>t=>{let n="function"==typeof e?e(t):e;for(let r=0;r<n.length;r+=1)if(n[r](t))return!0;return!1};function er(e){return e instanceof r.Bs}function eo(e=0,t=0,n=0){return Math.min(Math.max(e,t),n)}function ei(e,t=null){if(!t)return null;let n=r.Y1.atStart(e),o=r.Y1.atEnd(e);if("start"===t||!0===t)return n;if("end"===t)return o;let i=n.from,s=o.to;return"all"===t?r.Bs.create(e,eo(0,i,s),eo(e.content.size,i,s)):r.Bs.create(e,eo(t,i,s),eo(t,i,s))}function es(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}let ea=(e=null,t={})=>({editor:n,view:r,tr:o,dispatch:i})=>{t={scrollIntoView:!0,...t};let s=()=>{es()&&r.dom.focus(),requestAnimationFrame(()=>{!n.isDestroyed&&(r.focus(),(null==t?void 0:t.scrollIntoView)&&n.commands.scrollIntoView())})};if(r.hasFocus()&&null===e||!1===e)return!0;if(i&&null===e&&!er(n.state.selection))return s(),!0;let a=ei(o.doc,e)||n.state.selection,l=n.state.selection.eq(a);return i&&(l||o.setSelection(a),l&&o.storedMarks&&o.setStoredMarks(o.storedMarks),s()),!0},el=(e,t)=>n=>e.every((e,r)=>t(e,{...n,index:r})),ed=(e,t)=>({tr:n,commands:r})=>r.insertContentAt({from:n.selection.from,to:n.selection.to},e,t),ec=e=>{let t=e.childNodes;for(let n=t.length-1;n>=0;n-=1){let r=t[n];3===r.nodeType&&r.nodeValue&&!/\S/.test(r.nodeValue)?e.removeChild(r):1===r.nodeType&&ec(r)}return e};function eu(e){let t=`<body>${e}</body>`,n=new window.DOMParser().parseFromString(t,"text/html").body;return ec(n),ec(n)}function ep(e,t,n){if(n={slice:!0,parseOptions:{},...n},"object"==typeof e&&null!==e)try{if(Array.isArray(e)&&e.length>0)return s.HY.fromArray(e.map(e=>t.nodeFromJSON(e)));return t.nodeFromJSON(e)}catch(r){return console.warn("[tiptap warn]: Invalid content.","Passed value:",e,"Error:",r),ep("",t,n)}if("string"==typeof e){let o=s.aw.fromSchema(t);return n.slice?o.parseSlice(eu(e),n.parseOptions).content:o.parse(eu(e),n.parseOptions)}return ep("",t,n)}let ef=e=>e.toString().startsWith("<"),em=(e,t,n)=>({tr:o,dispatch:i,editor:s})=>{if(i){n={parseOptions:{},updateSelection:!0,...n};let l=ep(t,s.schema,{parseOptions:{preserveWhitespace:"full",...n.parseOptions}});if("<>"===l.toString())return!0;let{from:d,to:c}="number"==typeof e?{from:e,to:e}:{from:e.from,to:e.to},u=!0,p=!0,f=ef(l)?l:[l];if(f.forEach(e=>{e.check(),u=!!u&&e.isText&&0===e.marks.length,p=!!p&&e.isBlock}),d===c&&p){let{parent:m}=o.doc.resolve(d),h=m.isTextblock&&!m.type.spec.code&&!m.childCount;h&&(d-=1,c+=1)}u?Array.isArray(t)?o.insertText(t.map(e=>e.text||"").join(""),d,c):"object"==typeof t&&t&&t.text?o.insertText(t.text,d,c):o.insertText(t,d,c):o.replaceWith(d,c,l),n.updateSelection&&function(e,t,n){let o=e.steps.length-1;if(o<t)return;let i=e.steps[o];if(!(i instanceof a.Pu||i instanceof a.FC))return;let s=e.mapping.maps[o],l=0;s.forEach((e,t,n,r)=>{0===l&&(l=r)}),e.setSelection(r.Y1.near(e.doc.resolve(l),-1))}(o,o.steps.length-1,0)}return!0},eh=()=>({state:e,dispatch:t})=>(0,l.MI)(e,t),eg=()=>({state:e,dispatch:t})=>(0,l.Ig)(e,t),ey=()=>({state:e,dispatch:t})=>(0,l.al)(e,t),eb=()=>({state:e,dispatch:t})=>(0,l.Y_)(e,t),ev=()=>({tr:e,state:t,dispatch:n})=>{try{let r=(0,a.GJ)(t.doc,t.selection.$from.pos,-1);if(null==r)return!1;return e.join(r,2),n&&n(e),!0}catch{return!1}},ew=()=>({state:e,dispatch:t,tr:n})=>{try{let r=(0,a.GJ)(e.doc,e.selection.$from.pos,1);if(null==r)return!1;return n.join(r,2),t&&t(n),!0}catch(o){return!1}};function ek(){return"undefined"!=typeof navigator&&/Mac/.test(navigator.platform)}let ex=e=>({editor:t,view:n,tr:r,dispatch:o})=>{let i=(function(e){let t,n,r,o;let i=e.split(/-(?!$)/),s=i[i.length-1];"Space"===s&&(s=" ");for(let a=0;a<i.length-1;a+=1){let l=i[a];if(/^(cmd|meta|m)$/i.test(l))o=!0;else if(/^a(lt)?$/i.test(l))t=!0;else if(/^(c|ctrl|control)$/i.test(l))n=!0;else if(/^s(hift)?$/i.test(l))r=!0;else if(/^mod$/i.test(l))es()||ek()?o=!0:n=!0;else throw Error(`Unrecognized modifier name: ${l}`)}return t&&(s=`Alt-${s}`),n&&(s=`Ctrl-${s}`),o&&(s=`Meta-${s}`),r&&(s=`Shift-${s}`),s})(e).split(/-(?!$)/),s=i.find(e=>!["Alt","Ctrl","Meta","Shift"].includes(e)),a=new KeyboardEvent("keydown",{key:"Space"===s?" ":s,altKey:i.includes("Alt"),ctrlKey:i.includes("Ctrl"),metaKey:i.includes("Meta"),shiftKey:i.includes("Shift"),bubbles:!0,cancelable:!0}),l=t.captureTransaction(()=>{n.someProp("handleKeyDown",e=>e(n,a))});return null==l||l.steps.forEach(e=>{let t=e.map(r.mapping);t&&o&&r.maybeStep(t)}),!0};function eM(e,t,n={}){let{from:r,to:o,empty:i}=e.selection,s=t?g(t,e.schema):null,a=[];e.doc.nodesBetween(r,o,(e,t)=>{if(e.isText)return;let n=Math.min(o,t+e.nodeSize);a.push({node:e,from:Math.max(r,t),to:n})});let l=a.filter(e=>!s||s.name===e.node.type.name).filter(e=>Q(e.node.attrs,n,{strict:!1}));if(i)return!!l.length;let d=l.reduce((e,t)=>e+t.to-t.from,0);return d>=o-r}let eS=(e,t={})=>({state:n,dispatch:r})=>{let o=g(e,n.schema),i=eM(n,o,t);return!!i&&(0,l.xb)(n,r)},eO=()=>({state:e,dispatch:t})=>(0,l.X0)(e,t),eE=e=>({state:t,dispatch:n})=>{let r=g(e,t.schema);return(0,d.IB)(r)(t,n)},eC=()=>({state:e,dispatch:t})=>(0,l.QK)(e,t);function eT(e,t){return t.nodes[e]?"node":t.marks[e]?"mark":null}function eA(e,t){let n="string"==typeof t?[t]:t;return Object.keys(e).reduce((t,r)=>(n.includes(r)||(t[r]=e[r]),t),{})}let eP=(e,t)=>({tr:n,state:r,dispatch:o})=>{let i=null,s=null,a=eT("string"==typeof e?e:e.name,r.schema);return!!a&&("node"===a&&(i=g(e,r.schema)),"mark"===a&&(s=ee(e,r.schema)),o&&n.selection.ranges.forEach(e=>{r.doc.nodesBetween(e.$from.pos,e.$to.pos,(e,r)=>{i&&i===e.type&&n.setNodeMarkup(r,void 0,eA(e.attrs,t)),s&&e.marks.length&&e.marks.forEach(o=>{s===o.type&&n.addMark(r,r+e.nodeSize,s.create(eA(o.attrs,t)))})})}),!0)},ej=()=>({tr:e,dispatch:t})=>(t&&e.scrollIntoView(),!0),eN=()=>({tr:e,commands:t})=>t.setTextSelection({from:0,to:e.doc.content.size}),eB=()=>({state:e,dispatch:t})=>(0,l._M)(e,t),e$=()=>({state:e,dispatch:t})=>(0,l.o)(e,t),eI=()=>({state:e,dispatch:t})=>(0,l.N0)(e,t),eR=()=>({state:e,dispatch:t})=>(0,l.nw)(e,t),eD=()=>({state:e,dispatch:t})=>(0,l.U9)(e,t);function ez(e,t,n={}){return ep(e,t,{slice:!1,parseOptions:n})}let eL=(e,t=!1,n={})=>({tr:r,editor:o,dispatch:i})=>{let{doc:s}=r,a=ez(e,o.schema,n);return i&&r.replaceWith(0,s.content.size,a).setMeta("preventUpdate",!t),!0};function eH(e,t){let n=ee(t,e.schema),{from:r,to:o,empty:i}=e.selection,s=[];i?(e.storedMarks&&s.push(...e.storedMarks),s.push(...e.selection.$head.marks())):e.doc.nodesBetween(r,o,e=>{s.push(...e.marks)});let a=s.find(e=>e.type.name===n.name);return a?{...a.attrs}:{}}function eF(e,t){let n=new a.wx(e);return t.forEach(e=>{e.steps.forEach(e=>{n.step(e)})}),n}function eV(e,t,n){let r=[];return e.nodesBetween(t.from,t.to,(e,t)=>{n(e)&&r.push({node:e,pos:t})}),r}function eK(e){return t=>(function(e,t){for(let n=e.depth;n>0;n-=1){let r=e.node(n);if(t(r))return{pos:n>0?e.before(n):0,start:e.start(n),depth:n,node:r}}})(t.$from,e)}function eW(e,t){let n=eT("string"==typeof t?t:t.name,e.schema);return"node"===n?function(e,t){let n=g(t,e.schema),{from:r,to:o}=e.selection,i=[];e.doc.nodesBetween(r,o,e=>{i.push(e)});let s=i.reverse().find(e=>e.type.name===n.name);return s?{...s.attrs}:{}}(e,t):"mark"===n?eH(e,t):{}}function eJ(e){let{mapping:t,steps:n}=e,r=[];return t.maps.forEach((e,o)=>{let i=[];if(e.ranges.length)e.forEach((e,t)=>{i.push({from:e,to:t})});else{let{from:s,to:a}=n[o];if(void 0===s||void 0===a)return;i.push({from:s,to:a})}i.forEach(({from:e,to:n})=>{let i=t.slice(o).map(e,-1),s=t.slice(o).map(n),a=t.invert().map(i,-1),l=t.invert().map(s);r.push({oldRange:{from:a,to:l},newRange:{from:i,to:s}})})}),function(e){let t=function(e,t=JSON.stringify){let n={};return e.filter(e=>{let r=t(e);return!Object.prototype.hasOwnProperty.call(n,r)&&(n[r]=!0)})}(e);return 1===t.length?t:t.filter((e,n)=>{let r=t.filter((e,t)=>t!==n);return!r.some(t=>e.oldRange.from>=t.oldRange.from&&e.oldRange.to<=t.oldRange.to&&e.newRange.from>=t.newRange.from&&e.newRange.to<=t.newRange.to)})}(r)}function eG(e,t,n){let r=[];return e===t?n.resolve(e).marks().forEach(t=>{let o=n.resolve(e-1),i=Z(o,t.type);i&&r.push({mark:t,...i})}):n.nodesBetween(e,t,(e,t)=>{e&&void 0!==e.nodeSize&&r.push(...e.marks.map(n=>({from:t,to:t+e.nodeSize,mark:n})))}),r}function eU(e,t,n){return Object.fromEntries(Object.entries(n).filter(([n])=>{let r=e.find(e=>e.type===t&&e.name===n);return!!r&&r.attribute.keepOnSplit}))}function e_(e,t,n={}){let{empty:r,ranges:o}=e.selection,i=t?ee(t,e.schema):null;if(r)return!!(e.storedMarks||e.selection.$from.marks()).filter(e=>!i||i.name===e.type.name).find(e=>Q(e.attrs,n,{strict:!1}));let s=0,a=[];if(o.forEach(({$from:t,$to:n})=>{let r=t.pos,o=n.pos;e.doc.nodesBetween(r,o,(e,t)=>{if(!e.isText&&!e.marks.length)return;let n=Math.max(r,t),i=Math.min(o,t+e.nodeSize);s+=i-n,a.push(...e.marks.map(e=>({mark:e,from:n,to:i})))})}),0===s)return!1;let l=a.filter(e=>!i||i.name===e.mark.type.name).filter(e=>Q(e.mark.attrs,n,{strict:!1})).reduce((e,t)=>e+t.to-t.from,0),d=a.filter(e=>!i||e.mark.type!==i&&e.mark.type.excludes(i)).reduce((e,t)=>e+t.to-t.from,0);return(l>0?l+d:l)>=s}function eq(e,t){let{nodeExtensions:n}=m(t),r=n.find(t=>t.name===e);if(!r)return!1;let o={name:r.name,options:r.options,storage:r.storage},i=w(f(r,"group",o));return"string"==typeof i&&i.split(" ").includes("list")}let eY=(e,t={})=>({tr:n,state:r,dispatch:o})=>{let{selection:i}=n,{empty:s,ranges:a}=i,l=ee(e,r.schema);if(o){if(s){let d=eH(r,l);n.addStoredMark(l.create({...d,...t}))}else a.forEach(e=>{let o=e.$from.pos,i=e.$to.pos;r.doc.nodesBetween(o,i,(e,r)=>{let s=Math.max(r,o),a=Math.min(r+e.nodeSize,i),d=e.marks.find(e=>e.type===l);d?e.marks.forEach(e=>{l===e.type&&n.addMark(s,a,l.create({...e.attrs,...t}))}):n.addMark(s,a,l.create(t))})})}return function(e,t,n){var r;let{selection:o}=t,i=null;if(er(o)&&(i=o.$cursor),i){let s=null!==(r=e.storedMarks)&&void 0!==r?r:i.marks();return!!n.isInSet(s)||!s.some(e=>e.type.excludes(n))}let{ranges:a}=o;return a.some(({$from:t,$to:r})=>{let o=0===t.depth&&e.doc.inlineContent&&e.doc.type.allowsMarkType(n);return e.doc.nodesBetween(t.pos,r.pos,(e,t,r)=>{if(o)return!1;if(e.isInline){let i=!r||r.type.allowsMarkType(n),s=!!n.isInSet(e.marks)||!e.marks.some(e=>e.type.excludes(n));o=i&&s}return!o}),o})}(r,n,l)},eQ=(e,t)=>({tr:n})=>(n.setMeta(e,t),!0),eX=(e,t={})=>({state:n,dispatch:r,chain:o})=>{let i=g(e,n.schema);return i.isTextblock?o().command(({commands:e})=>{let r=(0,l.uJ)(i,t)(n);return!!r||e.clearNodes()}).command(({state:e})=>(0,l.uJ)(i,t)(e,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},eZ=e=>({tr:t,dispatch:n})=>{if(n){let{doc:o}=t,i=eo(e,0,o.content.size),s=r.qv.create(o,i);t.setSelection(s)}return!0},e0=e=>({tr:t,dispatch:n})=>{if(n){let{doc:o}=t,{from:i,to:s}="number"==typeof e?{from:e,to:e}:e,a=r.Bs.atStart(o).from,l=r.Bs.atEnd(o).to,d=eo(i,a,l),c=eo(s,a,l),u=r.Bs.create(o,d,c);t.setSelection(u)}return!0},e1=e=>({state:t,dispatch:n})=>{let r=g(e,t.schema);return(0,d.bw)(r)(t,n)};function e2(e,t){let n=e.storedMarks||e.selection.$to.parentOffset&&e.selection.$from.marks();if(n){let r=n.filter(e=>null==t?void 0:t.includes(e.type.name));e.tr.ensureMarks(r)}}let e3=({keepMarks:e=!0}={})=>({tr:t,state:n,dispatch:o,editor:i})=>{let{selection:s,doc:l}=t,{$from:d,$to:c}=s,u=i.extensionManager.attributes,p=eU(u,d.node().type.name,d.node().attrs);if(s instanceof r.qv&&s.node.isBlock)return!!(d.parentOffset&&(0,a.Ax)(l,d.pos))&&(o&&(e&&e2(n,i.extensionManager.splittableMarks),t.split(d.pos).scrollIntoView()),!0);if(!d.parent.isBlock)return!1;if(o){let f=c.parentOffset===c.parent.content.size;s instanceof r.Bs&&t.deleteSelection();let m=0===d.depth?void 0:function(e){for(let t=0;t<e.edgeCount;t+=1){let{type:n}=e.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}(d.node(-1).contentMatchAt(d.indexAfter(-1))),h=f&&m?[{type:m,attrs:p}]:void 0,g=(0,a.Ax)(t.doc,t.mapping.map(d.pos),1,h);if(!h&&!g&&(0,a.Ax)(t.doc,t.mapping.map(d.pos),1,m?[{type:m}]:void 0)&&(g=!0,h=m?[{type:m,attrs:p}]:void 0),g&&(t.split(t.mapping.map(d.pos),1,h),m&&!f&&!d.parentOffset&&d.parent.type!==m)){let y=t.mapping.map(d.before()),b=t.doc.resolve(y);d.node(-1).canReplaceWith(b.index(),b.index()+1,m)&&t.setNodeMarkup(t.mapping.map(d.before()),m)}e&&e2(n,i.extensionManager.splittableMarks),t.scrollIntoView()}return!0},e5=e=>({tr:t,state:n,dispatch:o,editor:i})=>{var l;let d=g(e,n.schema),{$from:c,$to:u}=n.selection,p=n.selection.node;if(p&&p.isBlock||c.depth<2||!c.sameParent(u))return!1;let f=c.node(-1);if(f.type!==d)return!1;let m=i.extensionManager.attributes;if(0===c.parent.content.size&&c.node(-1).childCount===c.indexAfter(-1)){if(2===c.depth||c.node(-3).type!==d||c.index(-2)!==c.node(-2).childCount-1)return!1;if(o){let h=s.HY.empty,y=c.index(-1)?1:c.index(-2)?2:3;for(let b=c.depth-y;b>=c.depth-3;b-=1)h=s.HY.from(c.node(b).copy(h));let v=c.indexAfter(-1)<c.node(-2).childCount?1:c.indexAfter(-2)<c.node(-3).childCount?2:3,w=eU(m,c.node().type.name,c.node().attrs),k=(null===(l=d.contentMatch.defaultType)||void 0===l?void 0:l.createAndFill(w))||void 0;h=h.append(s.HY.from(d.createAndFill(null,k)||void 0));let x=c.before(c.depth-(y-1));t.replace(x,c.after(-v),new s.p2(h,4-y,0));let M=-1;t.doc.nodesBetween(x,t.doc.content.size,(e,t)=>{if(M>-1)return!1;e.isTextblock&&0===e.content.size&&(M=t+1)}),M>-1&&t.setSelection(r.Bs.near(t.doc.resolve(M))),t.scrollIntoView()}return!0}let S=u.pos===c.end()?f.contentMatchAt(0).defaultType:null,O=eU(m,f.type.name,f.attrs),E=eU(m,c.node().type.name,c.node().attrs);if(t.delete(c.pos,u.pos),!(0,a.Ax)(t.doc,c.pos,2))return!1;if(o){let{selection:C,storedMarks:T}=n,{splittableMarks:A}=i.extensionManager,P=T||C.$to.parentOffset&&C.$from.marks();if(t.split(c.pos,2,S?[{type:d,attrs:O},{type:S,attrs:E}]:[{type:d,attrs:O}]).scrollIntoView(),!P||!o)return!0;let j=P.filter(e=>A.includes(e.type.name));t.ensureMarks(j)}return!0},e8=(e,t)=>{let n=eK(e=>e.type===t)(e.selection);if(!n)return!0;let r=e.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(void 0===r)return!0;let o=e.doc.nodeAt(r),i=n.node.type===(null==o?void 0:o.type)&&(0,a.Mn)(e.doc,n.pos);return!i||(e.join(n.pos),!0)},e6=(e,t)=>{let n=eK(e=>e.type===t)(e.selection);if(!n)return!0;let r=e.doc.resolve(n.start).after(n.depth);if(void 0===r)return!0;let o=e.doc.nodeAt(r),i=n.node.type===(null==o?void 0:o.type)&&(0,a.Mn)(e.doc,r);return!i||(e.join(r),!0)},e9=(e,t,n,r={})=>({editor:o,tr:i,state:s,dispatch:a,chain:l,commands:d,can:c})=>{let{extensions:u,splittableMarks:p}=o.extensionManager,f=g(e,s.schema),m=g(t,s.schema),{selection:h,storedMarks:y}=s,{$from:b,$to:v}=h,w=b.blockRange(v),k=y||h.$to.parentOffset&&h.$from.marks();if(!w)return!1;let x=eK(e=>eq(e.type.name,u))(h);if(w.depth>=1&&x&&w.depth-x.depth<=1){if(x.node.type===f)return d.liftListItem(m);if(eq(x.node.type.name,u)&&f.validContent(x.node.content)&&a)return l().command(()=>(i.setNodeMarkup(x.pos,f),!0)).command(()=>e8(i,f)).command(()=>e6(i,f)).run()}return n&&k&&a?l().command(()=>{let e=c().wrapInList(f,r),t=k.filter(e=>p.includes(e.type.name));return i.ensureMarks(t),!!e||d.clearNodes()}).wrapInList(f,r).command(()=>e8(i,f)).command(()=>e6(i,f)).run():l().command(()=>{let e=c().wrapInList(f,r);return!!e||d.clearNodes()}).wrapInList(f,r).command(()=>e8(i,f)).command(()=>e6(i,f)).run()},e4=(e,t={},n={})=>({state:r,commands:o})=>{let{extendEmptyMarkRange:i=!1}=n,s=ee(e,r.schema),a=e_(r,s,t);return a?o.unsetMark(s,{extendEmptyMarkRange:i}):o.setMark(s,t)},e7=(e,t,n={})=>({state:r,commands:o})=>{let i=g(e,r.schema),s=g(t,r.schema),a=eM(r,i,n);return a?o.setNode(s):o.setNode(i,n)},te=(e,t={})=>({state:n,commands:r})=>{let o=g(e,n.schema),i=eM(n,o,t);return i?r.lift(o):r.wrapIn(o,t)},tt=()=>({state:e,dispatch:t})=>{let n=e.plugins;for(let r=0;r<n.length;r+=1){let o;let i=n[r];if(i.spec.isInputRules&&(o=i.getState(e))){if(t){let s=e.tr,a=o.transform;for(let l=a.steps.length-1;l>=0;l-=1)s.step(a.steps[l].invert(a.docs[l]));if(o.text){let d=s.doc.resolve(o.from).marks();s.replaceWith(o.from,o.to,e.schema.text(o.text,d))}else s.delete(o.from,o.to)}return!0}}return!1},tn=()=>({tr:e,dispatch:t})=>{let{selection:n}=e,{empty:r,ranges:o}=n;return!!r||(t&&o.forEach(t=>{e.removeMark(t.$from.pos,t.$to.pos)}),!0)},tr=(e,t={})=>({tr:n,state:r,dispatch:o})=>{var i;let{extendEmptyMarkRange:s=!1}=t,{selection:a}=n,l=ee(e,r.schema),{$from:d,empty:c,ranges:u}=a;if(!o)return!0;if(c&&s){let{from:p,to:f}=a,m=null===(i=d.marks().find(e=>e.type===l))||void 0===i?void 0:i.attrs,h=Z(d,l,m);h&&(p=h.from,f=h.to),n.removeMark(p,f,l)}else u.forEach(e=>{n.removeMark(e.$from.pos,e.$to.pos,l)});return n.removeStoredMark(l),!0},to=(e,t={})=>({tr:n,state:r,dispatch:o})=>{let i=null,s=null,a=eT("string"==typeof e?e:e.name,r.schema);return!!a&&("node"===a&&(i=g(e,r.schema)),"mark"===a&&(s=ee(e,r.schema)),o&&n.selection.ranges.forEach(e=>{let o=e.$from.pos,a=e.$to.pos;r.doc.nodesBetween(o,a,(e,r)=>{i&&i===e.type&&n.setNodeMarkup(r,void 0,{...e.attrs,...t}),s&&e.marks.length&&e.marks.forEach(i=>{if(s===i.type){let l=Math.min(r+e.nodeSize,a);n.addMark(Math.max(r,o),l,s.create({...i.attrs,...t}))}})})}),!0)},ti=(e,t={})=>({state:n,dispatch:r})=>{let o=g(e,n.schema);return(0,l.ym)(o,t)(n,r)},ts=(e,t={})=>({state:n,dispatch:r})=>{let o=g(e,n.schema);return(0,d.KI)(o,t)(n,r)};var ta=Object.freeze({__proto__:null,blur:L,clearContent:H,clearNodes:F,command:V,createParagraphNear:K,cut:W,deleteCurrentNode:J,deleteNode:G,deleteRange:U,deleteSelection:_,enter:q,exitCode:Y,extendMarkRange:et,first:en,focus:ea,forEach:el,insertContent:ed,insertContentAt:em,joinUp:eh,joinDown:eg,joinBackward:ey,joinForward:eb,joinItemBackward:ev,joinItemForward:ew,keyboardShortcut:ex,lift:eS,liftEmptyBlock:eO,liftListItem:eE,newlineInCode:eC,resetAttributes:eP,scrollIntoView:ej,selectAll:eN,selectNodeBackward:eB,selectNodeForward:e$,selectParentNode:eI,selectTextblockEnd:eR,selectTextblockStart:eD,setContent:eL,setMark:eY,setMeta:eQ,setNode:eX,setNodeSelection:eZ,setTextSelection:e0,sinkListItem:e1,splitBlock:e3,splitListItem:e5,toggleList:e9,toggleMark:e4,toggleNode:e7,toggleWrap:te,undoInputRule:tt,unsetAllMarks:tn,unsetMark:tr,updateAttributes:to,wrapIn:ti,wrapInList:ts});let tl=I.create({name:"commands",addCommands:()=>({...ta})}),td=I.create({name:"editable",addProseMirrorPlugins(){return[new r.Sy({key:new r.H$("editable"),props:{editable:()=>this.editor.options.editable}})]}}),tc=I.create({name:"focusEvents",addProseMirrorPlugins(){let{editor:e}=this;return[new r.Sy({key:new r.H$("focusEvents"),props:{handleDOMEvents:{focus:(t,n)=>{e.isFocused=!0;let r=e.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return t.dispatch(r),!1},blur:(t,n)=>{e.isFocused=!1;let r=e.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return t.dispatch(r),!1}}}})]}}),tu=I.create({name:"keymap",addKeyboardShortcuts(){let e=()=>this.editor.commands.first(({commands:e})=>[()=>e.undoInputRule(),()=>e.command(({tr:t})=>{let{selection:n,doc:o}=t,{empty:i,$anchor:s}=n,{pos:a,parent:l}=s,d=s.parent.isTextblock?t.doc.resolve(a-1):s,c=d.parent.type.spec.isolating,u=s.pos-s.parentOffset,p=c&&1===d.parent.childCount?u===s.pos:r.Y1.atStart(o).from===a;return!!i&&!!p&&!!l.type.isTextblock&&!l.textContent.length&&e.clearNodes()}),()=>e.deleteSelection(),()=>e.joinBackward(),()=>e.selectNodeBackward()]),t=()=>this.editor.commands.first(({commands:e})=>[()=>e.deleteSelection(),()=>e.deleteCurrentNode(),()=>e.joinForward(),()=>e.selectNodeForward()]),n=()=>this.editor.commands.first(({commands:e})=>[()=>e.newlineInCode(),()=>e.createParagraphNear(),()=>e.liftEmptyBlock(),()=>e.splitBlock()]),o={Enter:n,"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:e,"Mod-Backspace":e,"Shift-Backspace":e,Delete:t,"Mod-Delete":t,"Mod-a":()=>this.editor.commands.selectAll()},i={...o},s={...o,"Ctrl-h":e,"Alt-Backspace":e,"Ctrl-d":t,"Ctrl-Alt-Backspace":t,"Alt-Delete":t,"Alt-d":t,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return es()||ek()?s:i},addProseMirrorPlugins(){return[new r.Sy({key:new r.H$("clearDocument"),appendTransaction:(e,t,n)=>{let o=e.some(e=>e.docChanged)&&!t.doc.eq(n.doc);if(!o)return;let{empty:i,from:s,to:a}=t.selection,l=r.Y1.atStart(t.doc).from,d=r.Y1.atEnd(t.doc).to;if(i||!(s===l&&a===d))return;let p=0===n.doc.textBetween(0,n.doc.content.size," "," ").length;if(!p)return;let f=n.tr,m=c({state:n,transaction:f}),{commands:h}=new u({editor:this.editor,state:m});if(h.clearNodes(),f.steps.length)return f}})]}}),tp=I.create({name:"tabindex",addProseMirrorPlugins(){return[new r.Sy({key:new r.H$("tabindex"),props:{attributes:this.editor.isEditable?{tabindex:"0"}:{}}})]}});var tf=Object.freeze({__proto__:null,ClipboardTextSerializer:z,Commands:tl,Editable:td,FocusEvents:tc,Keymap:tu,Tabindex:tp});let tm=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 1px !important;
  height: 1px !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;class th extends p{constructor(e={}){super(),this.isFocused=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}))},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=function(e,t,n){let r=document.querySelector(`style[data-tiptap-style${n?`-${n}`:""}]`);if(null!==r)return r;let o=document.createElement("style");return t&&o.setAttribute("nonce",t),o.setAttribute(`data-tiptap-style${n?`-${n}`:""}`,""),o.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(o),o}(tm,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},this.view&&this.state&&!this.isDestroyed&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,t=!0){this.setOptions({editable:e}),t&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,t){let n=v(t)?t(e,[...this.state.plugins]):[...this.state.plugins,e],r=this.state.reconfigure({plugins:n});this.view.updateState(r)}unregisterPlugin(e){if(this.isDestroyed)return;let t="string"==typeof e?`${e}$`:e.key,n=this.state.reconfigure({plugins:this.state.plugins.filter(e=>!e.key.startsWith(t))});this.view.updateState(n)}createExtensionManager(){let e=this.options.enableCoreExtensions?Object.values(tf):[],t=[...e,...this.options.extensions].filter(e=>["extension","node","mark"].includes(null==e?void 0:e.type));this.extensionManager=new N(t,this)}createCommandManager(){this.commandManager=new u({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){let e=ez(this.options.content,this.schema,this.options.parseOptions),t=ei(e,this.options.autofocus);this.view=new o.tk(this.options.element,{...this.options.editorProps,dispatchTransaction:this.dispatchTransaction.bind(this),state:r.yy.create({doc:e,selection:t||void 0})});let n=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(n),this.createNodeViews(),this.prependClass();let i=this.view.dom;i.editor=this}createNodeViews(){this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;let t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(e=>{var t;return null===(t=this.capturedTransaction)||void 0===t?void 0:t.step(e)});return}let t=this.state.apply(e),n=!this.state.selection.eq(t.selection);this.view.updateState(t),this.emit("transaction",{editor:this,transaction:e}),n&&this.emit("selectionUpdate",{editor:this,transaction:e});let r=e.getMeta("focus"),o=e.getMeta("blur");r&&this.emit("focus",{editor:this,event:r.event,transaction:e}),o&&this.emit("blur",{editor:this,event:o.event,transaction:e}),!e.docChanged||e.getMeta("preventUpdate")||this.emit("update",{editor:this,transaction:e})}getAttributes(e){return eW(this.state,e)}isActive(e,t){return function(e,t,n={}){if(!t)return eM(e,null,n)||e_(e,null,n);let r=eT(t,e.schema);return"node"===r?eM(e,t,n):"mark"===r&&e_(e,t,n)}(this.state,"string"==typeof e?e:null,"string"==typeof e?t:e)}getJSON(){return this.state.doc.toJSON()}getHTML(){return function(e,t){let n=s.PW.fromSchema(t).serializeFragment(e),r=document.implementation.createHTMLDocument(),o=r.createElement("div");return o.appendChild(n),o.innerHTML}(this.state.doc.content,this.schema)}getText(e){let{blockSeparator:t="\n\n",textSerializers:n={}}=e||{};return function(e,t){let n={from:0,to:e.content.size};return R(e,n,t)}(this.state.doc,{blockSeparator:t,textSerializers:{...D(this.schema),...n}})}get isEmpty(){return function(e){var t;let n=null===(t=e.type.createAndFill())||void 0===t?void 0:t.toJSON(),r=e.toJSON();return JSON.stringify(n)===JSON.stringify(r)}(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){this.emit("destroy"),this.view&&this.view.destroy(),this.removeAllListeners()}get isDestroyed(){var e;return!(null===(e=this.view)||void 0===e?void 0:e.docView)}}function tg(e){return new C({find:e.find,handler:({state:t,range:n,match:r})=>{let o=w(e.getAttributes,void 0,r);if(!1===o||null===o)return null;let{tr:i}=t,s=r[r.length-1],a=r[0];if(s){let l=a.search(/\S/),d=n.from+a.indexOf(s),c=d+s.length,u=eG(n.from,n.to,t.doc).filter(t=>{let n=t.mark.type.excluded;return n.find(n=>n===e.type&&n!==t.mark.type)}).filter(e=>e.to>d);if(u.length)return null;c<n.to&&i.delete(c,n.to),d>n.from&&i.delete(n.from+l,d);let p=n.from+l+s.length;i.addMark(n.from+l,p,e.type.create(o||{})),i.removeStoredMark(e.type)}}})}function ty(e){return new C({find:e.find,handler:({state:t,range:n,match:r})=>{let o=w(e.getAttributes,void 0,r)||{},{tr:i}=t,s=n.from,a=n.to,l=e.type.create(o);if(r[1]){let d=r[0].lastIndexOf(r[1]),c=s+d;c>a?c=a:a=c+r[1].length;let u=r[0][r[0].length-1];i.insertText(u,s+r[0].length-1),i.replaceWith(c,a,l)}else r[0]&&i.insert(s-1,e.type.create(o)).delete(i.mapping.map(s),i.mapping.map(a));i.scrollIntoView()}})}function tb(e){return new C({find:e.find,handler:({state:t,range:n,match:r})=>{let o=t.doc.resolve(n.from),i=w(e.getAttributes,void 0,r)||{};if(!o.node(-1).canReplaceWith(o.index(-1),o.indexAfter(-1),e.type))return null;t.tr.delete(n.from,n.to).setBlockType(n.from,n.from,e.type,i)}})}function tv(e){return new C({find:e.find,handler:({state:t,range:n,match:r,chain:o})=>{let i=w(e.getAttributes,void 0,r)||{},s=t.tr.delete(n.from,n.to),l=s.doc.resolve(n.from),d=l.blockRange(),c=d&&(0,a.nd)(d,e.type,i);if(!c)return null;if(s.wrap(d,c),e.keepMarks&&e.editor){let{selection:u,storedMarks:p}=t,{splittableMarks:f}=e.editor.extensionManager,m=p||u.$to.parentOffset&&u.$from.marks();if(m){let h=m.filter(e=>f.includes(e.type.name));s.ensureMarks(h)}}if(e.keepAttributes){let g="bulletList"===e.type.name||"orderedList"===e.type.name?"listItem":"taskList";o().updateAttributes(g,i).run()}let y=s.doc.resolve(n.from-1).nodeBefore;y&&y.type===e.type&&(0,a.Mn)(s.doc,n.from-1)&&(!e.joinPredicate||e.joinPredicate(r,y))&&s.join(n.from-1)}})}class tw{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=w(f(this,"addOptions",{name:this.name}))),this.storage=w(f(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new tw(e)}configure(e={}){let t=this.extend();return t.options=$(this.options,e),t.storage=w(f(t,"addStorage",{name:t.name,options:t.options})),t}extend(e={}){let t=new tw(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=w(f(t,"addOptions",{name:t.name})),t.storage=w(f(t,"addStorage",{name:t.name,options:t.options})),t}static handleExit({editor:e,mark:t}){let{tr:n}=e.state,r=e.state.selection.$from,o=r.pos===r.end();if(o){let i=r.marks(),s=!!i.find(e=>(null==e?void 0:e.type.name)===t.name);if(!s)return!1;let a=i.find(e=>(null==e?void 0:e.type.name)===t.name);return a&&n.removeStoredMark(a),n.insertText(" ",r.pos),e.view.dispatch(n),!0}return!1}}class tk{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=w(f(this,"addOptions",{name:this.name}))),this.storage=w(f(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new tk(e)}configure(e={}){let t=this.extend();return t.options=$(this.options,e),t.storage=w(f(t,"addStorage",{name:t.name,options:t.options})),t}extend(e={}){let t=new tk(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=w(f(t,"addOptions",{name:t.name})),t.storage=w(f(t,"addStorage",{name:t.name,options:t.options})),t}}function tx(e){return new P({find:e.find,handler:({state:t,range:n,match:r,pasteEvent:o})=>{let i=w(e.getAttributes,void 0,r,o);if(!1===i||null===i)return null;let{tr:s}=t,a=r[r.length-1],l=r[0],d=n.to;if(a){let c=l.search(/\S/),u=n.from+l.indexOf(a),p=u+a.length,f=eG(n.from,n.to,t.doc).filter(t=>{let n=t.mark.type.excluded;return n.find(n=>n===e.type&&n!==t.mark.type)}).filter(e=>e.to>u);if(f.length)return null;p<n.to&&s.delete(p,n.to),u>n.from&&s.delete(n.from+c,u),d=n.from+c+a.length,s.addMark(n.from+c,d,e.type.create(i||{})),s.removeStoredMark(e.type)}}})}}}]);