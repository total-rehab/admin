(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[564],{98854:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return si}});var r,i=s(85893),a=s(25980),l=s(33284),n=s(26405),o=s(90450),c=s(96322),d=s(63663),x=s(89250),u=s(36581),h=s(80227),j=s(60888),m=s(78317),p=s(93640),g=s(56693),v=s(63094),b=s(75071),y=s(94229),f=s(21075),A=s(15586),I=s(48571),w=s(30603),k=s(30702),T=s(57456),C=s(49933),P=s(97165),N=s(62751),D=s(43322),Z=s(74011);let W=()=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(D.o,{source:"name",validate:[(0,Z.C1)()],fullWidth:!0}),(0,i.jsx)(D.o,{source:"description",fullWidth:!0})]}),O=()=>(0,i.jsx)(k.ck,{children:(0,i.jsx)(W,{})}),S=()=>(0,i.jsx)(k.Py,{children:(0,i.jsx)(W,{})});var B=s(97032),E=s(73171),R=s(73850),F=s(18123),L=s(75214),q=s(81252),M=s(25482),U=s(96996),z=s(97005),H=s(66252),J=s(96540);let _=e=>{let{hasFilters:t,hasBulkCreate:s}=e;(0,L.K)();let r=(0,q.e)();return(0,i.jsxs)(M.Q,{children:[t&&(0,i.jsx)(U.L,{}),(0,i.jsx)(z.Z,{}),s&&(0,i.jsx)(H.z,{label:"Bulk Create",startIcon:(0,i.jsx)(J.Z,{}),href:"#/bulk-create/".concat(r)})]})},G=[(0,i.jsx)(D.o,{label:"Search by name",source:"q",alwaysOn:!0},"search")],K=()=>(0,i.jsx)(B.a,{actions:(0,i.jsx)(_,{hasFilters:!0}),perPage:25,filters:G,children:(0,i.jsxs)(E.c,{rowClick:"edit",bulkActionButtons:!1,children:[(0,i.jsx)(R.n,{source:"name"}),(0,i.jsx)(F.N,{source:"createdAt",textAlign:"center",showTime:!0}),(0,i.jsx)(F.N,{source:"updatedAt",textAlign:"center",showTime:!0}),(0,i.jsx)(R.n,{source:"id",textAlign:"center"})]})});var Y=s(67294),V=s(67739),X=s(37823),Q=s(15861),$=s(25675),ee=s.n($);let et=e=>(0,i.jsxs)(X.x,{...e,sx:{color:"white"},children:[(0,i.jsx)(Q.Z,{variant:"h6",color:"inherit",id:"react-admin-title"}),(0,i.jsx)("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,i.jsx)("div",{style:{display:"flex",position:"absolute",left:"50%",transform:"translateX(-50%)"},children:(0,i.jsx)(ee(),{priority:!0,src:"/images/total-rehab-logo.png",alt:"Total Rehab logo",width:175,height:25})})})]}),es=e=>(0,i.jsx)(V.A,{...e,appBar:et});var er=s(28421),ei=s(41397),ea=s(10536),el=s(57290);let en=e=>{let{source:t,reference:s,itemSource:r}=e;return(0,i.jsx)(ea.je,{source:t,reference:s,children:"string"==typeof r?(0,i.jsx)(R.n,{source:r}):(0,i.jsx)(el.J,{render:r})})},eo=[(0,i.jsx)(D.o,{label:"Search by name",source:"q",alwaysOn:!0},"search"),(0,i.jsx)(er.D,{source:"modalityId",reference:"modalities",children:(0,i.jsx)(ei.P,{label:"Modality",optionText:"name"})},"modality")],ec=()=>(0,i.jsx)(B.a,{actions:(0,i.jsx)(_,{hasFilters:!0}),perPage:25,filters:eo,children:(0,i.jsxs)(E.c,{rowClick:"edit",bulkActionButtons:!1,children:[(0,i.jsx)(R.n,{source:"name"}),(0,i.jsx)(en,{source:"modalityId",reference:"modalities",itemSource:"name"}),(0,i.jsx)(F.N,{source:"createdAt",textAlign:"center",showTime:!0}),(0,i.jsx)(F.N,{source:"updatedAt",textAlign:"center",showTime:!0}),(0,i.jsx)(R.n,{source:"id",textAlign:"center"})]})});var ed=s(83983),ex=s(25417);let eu=e=>(0,i.jsx)(ex.E,{parse:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.map(e=>"number"==typeof e?{id:e}:e)},format:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.map(e=>"number"==typeof e?e:e.id)},...e});var eh=s(2734),ej=s(5616);let em=e=>{let{children:t}=e,{spacing:s}=(0,eh.Z)();return(0,i.jsx)(ej.Z,{sx:{display:"flex",flex:1,width:"100%",gap:s(4),flexDirection:{xs:"column",lg:"row"},alignItems:"center"},children:t})},ep=()=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(D.o,{source:"name",validate:[(0,Z.C1)()],fullWidth:!0}),(0,i.jsx)(D.o,{source:"description",fullWidth:!0}),(0,i.jsxs)(em,{children:[(0,i.jsx)(P.nW,{source:"videoId",label:"Video"}),(0,i.jsx)(P.nW,{source:"heroImageId",label:"Hero Image"}),(0,i.jsx)(P.nW,{source:"thumbnailImageId",label:"Thumbnail Image"})]}),(0,i.jsx)(er.D,{label:"Activity",source:"modalityId",reference:"modalities",children:(0,i.jsx)(ei.P,{optionText:"name",fullWidth:!0,validate:(0,Z.C1)()})}),(0,i.jsx)(ed.u,{source:"equipment",reference:"equipment",children:(0,i.jsx)(eu,{fullWidth:!0,label:"Equipment",optionText:"name"})}),(0,i.jsx)(k.vA,{source:"instructions"}),(0,i.jsx)(k.vA,{source:"tips",addButtonText:"Add tip"})]}),eg=()=>(0,i.jsx)(k.ck,{children:(0,i.jsx)(ep,{})}),ev=()=>(0,i.jsx)(k.Py,{queryOptions:{meta:{include:{equipment:!0}}},children:(0,i.jsx)(ep,{})});var eb=s(94889),ey=s(14943),ef=s(12821),eA=s(87918);let eI=[(0,i.jsx)(D.o,{label:"Search by title",source:"q",alwaysOn:!0},"search"),(0,i.jsx)(eb.l,{source:"activityLevel",choices:[{id:"LIGHT",name:"Light"},{id:"MODERATE",name:"Moderate"},{id:"INTENSIVE",name:"Intensive"}]},"activityLevel"),(0,i.jsx)(ey.K,{label:"Over 60s",source:"isForOver60s"},"over60s"),(0,i.jsx)(ey.K,{source:"published"},"published")],ew=()=>{let e=(0,eh.Z)();return(0,i.jsx)(B.a,{actions:(0,i.jsx)(_,{hasFilters:!0}),perPage:25,filters:eI,children:(0,i.jsxs)(E.c,{rowClick:"edit",children:[(0,i.jsx)(R.n,{source:"title"}),(0,i.jsx)(ef.I,{label:"Over 60s",source:"isForOver60s",textAlign:"center"}),(0,i.jsx)(el.J,{label:"Activity Levels",textAlign:"center",render:t=>(0,i.jsx)(eA.Z,{label:(0,C.G)(t.activityLevel),sx:{margin:e.spacing(.5)}},t.activityLevel)}),(0,i.jsx)(ef.I,{source:"published",textAlign:"center"}),(0,i.jsx)(F.N,{source:"createdAt",textAlign:"center",showTime:!0}),(0,i.jsx)(F.N,{source:"updatedAt",textAlign:"center",showTime:!0}),(0,i.jsx)(R.n,{source:"id",textAlign:"center"})]})})};var ek=s(55666),eT=s(77333),eC=s(92456),eP=s(9732),eN=s(29002),eD=s(80497),eZ=s(55378),eW=s(48345),eO=s(59636),eS=s(78462),eB=s(70891),eE=s(59334),eR=s(25464),eF=s(18972),eL=s(90948),eq=s(41796),eM=s(45111),eU=s(86010);let ez=[{label:"Normal",value:"paragraph"},{label:"Heading 1",value:"heading",level:2},{label:"Heading 2",value:"heading",level:3},{label:"Heading 3",value:"heading",level:4},{label:"Heading 4",value:"heading",level:5}],eH="RaRichTextInputTextLevelSelect",eJ={list:"".concat(eH,"-list"),sizeSmall:"".concat(eH,"-sizeSmall"),sizeLarge:"".concat(eH,"-sizeLarge")},e_=(0,eL.ZP)("div")(e=>{let{theme:t}=e;return{border:"1px solid ".concat(t.palette.grey[300]),borderRadius:t.shape.borderRadius,["&.".concat(eJ.list)]:{borderRadius:t.shape.borderRadius,border:"1px solid ".concat((0,eq.Fq)(t.palette.action.active,.12))},["& .".concat(eJ.sizeSmall)]:{paddingTop:1,paddingBottom:1,"& .MuiTypography-root":{fontSize:t.typography.pxToRem(13)}},["& .".concat(eJ.sizeLarge)]:{paddingTop:8,paddingBottom:8,"& .MuiTypography-root":{fontSize:t.typography.pxToRem(15)}}}}),eG=e=>{let t=(0,eO.w)(),[s,r]=(0,Y.useState)(null),{size:a}=e,[l,n]=(0,Y.useState)(ez[0]),o=(e,s)=>{r(null);let i=ez[s];"paragraph"===i.value?t.chain().focus().setParagraph().run():"heading"===i.value&&t.chain().focus().setHeading({level:i.level}).run()},c=e=>{r(e.currentTarget)},d=()=>{r(null)};return(0,Y.useEffect)(()=>{let e=()=>{n(e=>ez.reduce((e,s)=>t&&("paragraph"===s.value&&t.isActive("paragraph")||t.isActive("heading",{level:s.level}))?s:e,e))};return t&&(t.on("update",e),t.on("selectionUpdate",e)),()=>{t&&(t.off("update",e),t.off("selectionUpdate",e))}},[t]),(0,i.jsxs)(e_,{children:[(0,i.jsx)(eS.Z,{component:"nav","aria-label":"Select the level",dense:!0,disablePadding:!0,className:eJ.list,children:(0,i.jsxs)(eB.ZP,{button:!0,"aria-haspopup":"true","aria-controls":"level-menu","aria-label":"Current level",disabled:!(null==t?void 0:t.isEditable),onClick:c,className:(0,eU.Z)({[eJ.sizeSmall]:"small"===a,[eJ.sizeLarge]:"large"===a}),children:[(0,i.jsx)(eE.Z,{primary:l.label}),(0,i.jsx)(eM.Z,{})]})}),(0,i.jsx)(eR.Z,{anchorEl:s,open:Boolean(s),id:"level-menu",onClose:d,children:ez.map((e,t)=>(0,i.jsx)(eF.Z,{selected:e===l,onClick:e=>{o(e,t)},children:e.label},e.label))})]})},eK=e=>(0,i.jsx)(eC.O,{...e,className:"prose max-w-none",toolbar:(0,i.jsx)("div",{style:{alignSelf:"flex-start"},children:(0,i.jsxs)(eP.A,{children:[(0,i.jsx)(eG,{}),(0,i.jsx)(eN.O,{}),(0,i.jsx)(eD.g,{}),(0,i.jsx)(eZ.$,{}),(0,i.jsx)(eW.o,{})]})})}),eY=(e,t)=>{let s=t.phases.map(e=>{let{phaseId:t}=e;return t}),r=s.filter((e,t)=>s.indexOf(e)!==t);if(r.includes(e))return"A phase should only be used once per program"},eV=()=>{let{spacing:e}=(0,eh.Z)();return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(D.o,{source:"title",validate:[(0,Z.C1)()],fullWidth:!0}),(0,i.jsxs)(em,{children:[(0,i.jsx)(P.nW,{source:"heroImageId",label:"Hero Image"}),(0,i.jsx)(P.nW,{source:"thumbnailImageId",label:"Thumbnail Image"})]}),(0,i.jsxs)(em,{children:[(0,i.jsx)(eb.l,{source:"activityLevel",validate:[(0,Z.C1)()],choices:[{id:"LIGHT",name:"Light"},{id:"MODERATE",name:"Moderate"},{id:"INTENSIVE",name:"Intensive"}]}),(0,i.jsx)(ey.K,{label:"Is over 60s program",source:"isForOver60s"})]}),(0,i.jsx)(k.vA,{source:"features",addButtonText:"Add feature"}),(0,i.jsx)(ek.qt,{source:"phases",sx:{marginBottom:e(4)},children:(0,i.jsxs)(k.vs,{inline:!0,addButtonText:"Add phase",children:[(0,i.jsx)(er.D,{source:"phaseId",reference:"phases",children:(0,i.jsx)(ei.P,{fullWidth:!0,label:"Phase",optionText:"name",validate:[(0,Z.C1)(),eY]})}),(0,i.jsx)(eT.Y,{fullWidth:!0,source:"durationInWeeks",validate:[(0,Z.C1)()]})]})}),(0,i.jsx)(eK,{source:"content",fullWidth:!0}),(0,i.jsx)(ey.K,{source:"published",helperText:"Programs that are not published will not appear in the app."})]})},eX=()=>(0,i.jsx)(k.ck,{children:(0,i.jsx)(eV,{})}),eQ=e=>(Object.assign(e,{phases:e.phases.map((e,t)=>({...e,rank:t}))}),e),e$=()=>(0,i.jsx)(k.Py,{queryOptions:{meta:{include:{phases:["phase"]}}},transform:eQ,children:(0,i.jsx)(eV,{})});var e0=s(22145),e1=s(58001),e2=s(9966),e5=s(81081),e6=s(33311);let e4=()=>(0,i.jsx)(e0.d,{children:(0,i.jsxs)(e1.r,{children:[(0,i.jsxs)(e1.r.Tab,{label:"summary",children:[(0,i.jsx)(R.n,{source:"title"}),(0,i.jsx)(ef.I,{source:"isForOver60s"}),(0,i.jsx)(R.n,{source:"activityLevel"})]}),(0,i.jsx)(e1.r.Tab,{label:"content",children:(0,i.jsx)(e2.U,{className:"prose",source:"content",label:!1})}),(0,i.jsx)(e1.r.Tab,{label:"tasks",path:"tasks",children:(0,i.jsx)(e5.E,{reference:"tasks",target:"programId",label:!1,children:(0,i.jsxs)(E.c,{rowClick:"edit",bulkActionButtons:!1,children:[(0,i.jsx)(e6.K,{source:"weekNumber",textAlign:"left"}),(0,i.jsx)(en,{source:"activityId",reference:"activities",itemSource:"name"}),(0,i.jsx)(R.n,{source:"reps",textAlign:"center"}),(0,i.jsx)(e6.K,{source:"sets",textAlign:"center"}),(0,i.jsx)(R.n,{source:"frequency",textAlign:"center"}),(0,i.jsx)(e6.K,{source:"restPeriod",textAlign:"center"}),(0,i.jsx)(e6.K,{source:"days",textAlign:"center"})]})})})]})});var e3=s(87525);let e9=()=>(0,e3.eI)("https://bflvfyeppolxjouqqaxp.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJmbHZmeWVwcG9seGpvdXFxYXhwIiwicm9sZSI6ImFub24iLCJpYXQiOjE2NzI4NTU2NjQsImV4cCI6MTk4ODQzMTY2NH0.cBu6dbiT0UsR4m1y9VdYjJH39T_3XVarDBbGRVRMi8E");var e7=s(15494);let e8="#263039",te={...e7.uH,palette:{secondary:{main:e8}}},tt=()=>(0,i.jsx)(B.a,{actions:(0,i.jsx)(i.Fragment,{}),children:(0,i.jsxs)(E.c,{rowClick:"edit",children:[(0,i.jsx)(P.kv,{}),(0,i.jsx)(R.n,{source:"title"}),(0,i.jsx)(el.J,{label:"Extension",textAlign:"center",render:e=>e.src.split(".").pop()}),(0,i.jsx)(F.N,{source:"createdAt",textAlign:"center",showTime:!0}),(0,i.jsx)(F.N,{source:"updatedAt",textAlign:"center",showTime:!0}),(0,i.jsx)(R.n,{source:"id",textAlign:"center"})]})}),ts=()=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(D.o,{source:"title",fullWidth:!0,validate:[(0,Z.C1)()]}),(0,i.jsx)(P.kv,{width:500})]}),tr=()=>(0,i.jsx)(k.ck,{children:(0,i.jsx)(ts,{})}),ti=()=>(0,i.jsx)(k.Py,{children:(0,i.jsx)(ts,{})}),ta=[(0,i.jsx)(er.D,{alwaysOn:!0,source:"programId",reference:"programs",children:(0,i.jsx)(ei.P,{sx:{width:300},label:"Select a program",optionText:e=>"".concat(e.title," - ").concat(e.isForOver60s?"Over 60s":"Under 60s"," - ").concat((0,C.G)(e.activityLevel))})},"program"),(0,i.jsx)(eT.Y,{source:"weekNumber"},"week")],tl=()=>(0,i.jsx)(B.a,{actions:(0,i.jsx)(_,{hasFilters:!0,hasBulkCreate:!0}),filters:ta,perPage:25,queryOptions:{meta:{include:{activity:!0}}},children:(0,i.jsxs)(E.c,{rowClick:"edit",children:[(0,i.jsx)(e6.K,{source:"weekNumber",textAlign:"center"}),(0,i.jsx)(en,{source:"activityId",reference:"activities",itemSource:"name"}),(0,i.jsx)(R.n,{source:"reps",textAlign:"center"}),(0,i.jsx)(e6.K,{source:"sets",textAlign:"center"}),(0,i.jsx)(el.J,{label:"Days",textAlign:"center",render:e=>e.days.sort().join()}),(0,i.jsx)(e6.K,{source:"priority",textAlign:"center"}),(0,i.jsx)(en,{source:"programId",reference:"programs",itemSource:e=>"".concat(e.title," - ").concat(e.isForOver60s?"Over 60s":"Under 60s"," - ").concat((0,C.G)(null!==(r=e.activityLevel)&&void 0!==r?r:""))}),(0,i.jsx)(F.N,{source:"createdAt",textAlign:"center",showTime:!0}),(0,i.jsx)(F.N,{source:"updatedAt",textAlign:"center",showTime:!0}),(0,i.jsx)(R.n,{source:"id",textAlign:"center"})]})});var tn=s(81405);let to=e=>{let{children:t,onProgramIdChange:s,onWeekChange:r}=e;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(er.D,{label:"Program",source:"programId",reference:"programs",children:(0,i.jsx)(ei.P,{onChange:s,optionText:e=>"".concat(e.title," - ").concat(e.isForOver60s?"Over 60s":"Under 60s"," - ").concat((0,C.G)(e.activityLevel)),fullWidth:!0,validate:(0,Z.C1)()})}),(0,i.jsx)(eT.Y,{fullWidth:!0,source:"weekNumber",validate:(0,Z.C1)(),onChange:e=>{null==r||r(e.target.value)}}),t,(0,i.jsx)(er.D,{label:"Activity",source:"activityId",reference:"activities",children:(0,i.jsx)(ei.P,{optionText:"name",fullWidth:!0,validate:(0,Z.C1)()})}),(0,i.jsxs)(em,{children:[(0,i.jsx)(eT.Y,{source:"sets"}),(0,i.jsx)(D.o,{source:"reps"}),(0,i.jsx)(D.o,{source:"restPeriod"}),(0,i.jsx)(D.o,{source:"frequency"})]}),(0,i.jsx)(tn.P,{source:"days",validate:(0,Z.C1)(),parse:e=>e.filter(e=>[1,2,3,4,5,6,7].includes(e)),choices:Array(7).fill(null).map((e,t)=>({id:t+1,name:"Day ".concat(t+1)}))}),(0,i.jsx)(eT.Y,{fullWidth:!0,source:"priority",min:1,validate:(0,Z.C1)()})]})},tc=e=>{let{children:t,onProgramIdChange:s,onWeekChange:r,mutationOptions:a}=e;return(0,i.jsx)(k.ck,{mutationOptions:a,children:(0,i.jsx)(to,{onProgramIdChange:s,onWeekChange:r,children:t})})},td=()=>(0,i.jsx)(k.Py,{children:(0,i.jsx)(to,{})}),tx=()=>(0,i.jsx)(B.a,{actions:(0,i.jsx)(_,{}),perPage:25,children:(0,i.jsxs)(E.c,{rowClick:"edit",bulkActionButtons:!1,children:[(0,i.jsx)(R.n,{source:"email"}),(0,i.jsx)(R.n,{source:"role"}),(0,i.jsx)(F.N,{source:"createdAt",textAlign:"center",showTime:!0}),(0,i.jsx)(F.N,{source:"updatedAt",textAlign:"center",showTime:!0}),(0,i.jsx)(R.n,{source:"id",textAlign:"center"})]})});var tu=s(57215);let th=()=>{let e=(0,a.j)(),{identity:t}=(0,tu.k)(),s=e.guid===(null==t?void 0:t.id),r=s?"You cannot update your own role":void 0;return(0,i.jsx)(eb.l,{source:"role",validate:[(0,Z.C1)(),()=>r],disabled:s,helperText:r,choices:[{id:"ADMIN",name:"Admin"},{id:"PRACTITIONER",name:"Practitioner"},{id:"USER",name:"User"}]})},tj=()=>{let e=(0,a.j)();return(0,i.jsxs)("span",{children:["User ",e?"".concat(e.email):""]})},tm=()=>(0,i.jsx)(k.Py,{title:(0,i.jsx)(tj,{}),children:(0,i.jsx)(th,{})}),tp=[(0,i.jsx)(D.o,{label:"Search by title",source:"q",alwaysOn:!0},"search")],tg=()=>(0,i.jsx)(B.a,{actions:(0,i.jsx)(_,{hasFilters:!0}),perPage:25,filters:tp,children:(0,i.jsxs)(E.c,{rowClick:"edit",children:[(0,i.jsx)(R.n,{source:"title"}),(0,i.jsx)(F.N,{source:"createdAt",textAlign:"center",showTime:!0}),(0,i.jsx)(F.N,{source:"updatedAt",textAlign:"center",showTime:!0}),(0,i.jsx)(R.n,{source:"id",textAlign:"center"})]})}),tv=()=>{let{spacing:e}=(0,eh.Z)();return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(D.o,{source:"title",validate:[(0,Z.C1)()],fullWidth:!0}),(0,i.jsxs)(em,{children:[(0,i.jsx)(P.nW,{source:"videoId",label:"Video"}),(0,i.jsx)(P.nW,{source:"heroImageId",label:"Hero Image"}),(0,i.jsx)(P.nW,{source:"thumbnailImageId",label:"Thumbnail Image"})]}),(0,i.jsx)(eK,{source:"content",fullWidth:!0}),(0,i.jsx)(ek.qt,{source:"phases",sx:{marginBottom:e(4)},children:(0,i.jsx)(k.vs,{addButtonText:"Add phase",children:(0,i.jsx)(er.D,{source:"id",reference:"phases",children:(0,i.jsx)(ei.P,{fullWidth:!0,label:"Phases",source:"",optionText:"name"})})})}),(0,i.jsx)(ek.qt,{source:"programs",sx:{marginBottom:e(4)},children:(0,i.jsx)(k.vs,{addButtonText:"Add program",children:(0,i.jsx)(er.D,{source:"id",reference:"programs",children:(0,i.jsx)(ei.P,{fullWidth:!0,label:"Programs",source:"",optionText:e=>(console.log("opt",e),"".concat(e.title," - ").concat(e.isForOver60s?"Over 60s":"Under 60s"," - ").concat((0,C.G)(e.activityLevel)))})})})})]})},tb=()=>(0,i.jsx)(k.ck,{children:(0,i.jsx)(tv,{})}),ty=()=>(0,i.jsx)(k.Py,{queryOptions:{meta:{include:{phases:!0,programs:!0}}},children:(0,i.jsx)(tv,{})}),tf=()=>{let{identity:e}=(0,tu.k)(),t=null==e?void 0:e.role;return(0,i.jsxs)(k.ck,{children:[(0,i.jsx)(D.o,{fullWidth:!0,source:"email",type:"email",label:"Email address",validate:[(0,Z.C1)()]}),(0,i.jsx)(eb.l,{source:"role",defaultValue:"USER",validate:[(0,Z.C1)()],choices:["ADMIN"===t&&{id:"ADMIN",name:"Admin"},{id:"PRACTITIONER",name:"Practitioner"},{id:"USER",name:"User"}].filter(e=>e)})]})};var tA=s(66596),tI=s(88912),tw=s(46082),tk=s(39324),tT=s(67720),tC=s(5973);let tP=()=>(0,i.jsx)(ej.Z,{textAlign:"center",m:1,sx:{width:"100%"},children:(0,i.jsx)(Q.Z,{variant:"body1",paragraph:!0,children:"Create tasks for the selected program and week by filling in the fields below."})}),tN=()=>{let{spacing:e}=(0,eh.Z)(),t=(0,tA.d)(),s=(0,tI.J)(),[r,a]=(0,Y.useState)(),[l,n]=(0,Y.useState)(),{onError:o}=(0,tC.useFormContext)(),c=(0,Y.useCallback)(()=>{t("Task created"),s()},[t,s]);return(0,i.jsx)(tw.U,{value:"tasks",children:(0,i.jsxs)(tc,{mutationOptions:{onSuccess:c,onError:o},onProgramIdChange:a,onWeekChange:n,children:[r&&(0,i.jsx)(B.a,{perPage:50,filter:{programId:r,weekNumber:l},actions:!1,sx:{width:"100%"},empty:(0,i.jsx)(tP,{}),children:(0,i.jsxs)(E.c,{rowClick:"edit",bulkActionButtons:!1,children:[(0,i.jsx)(e6.K,{source:"weekNumber",textAlign:"center"}),(0,i.jsx)(en,{source:"activityId",reference:"activities",itemSource:"name"}),(0,i.jsx)(e6.K,{source:"sets",textAlign:"center"}),(0,i.jsx)(R.n,{source:"reps",textAlign:"center"}),(0,i.jsx)(R.n,{source:"restPeriod",textAlign:"center"}),(0,i.jsx)(R.n,{source:"frequency",textAlign:"center"}),(0,i.jsx)(el.J,{label:"Days",textAlign:"center",render:e=>e.days.sort().join()})," ",(0,i.jsx)(tk.m,{redirect:!1})]})}),(0,i.jsx)(tT.Z,{light:!0,sx:{marginBottom:e(2)}})]})})};var tD=s(66242),tZ=s(78445),tW=s(77837),tO=s(23148),tS=s(49501);let tB="https://api.total-rehab.co.uk";if(!tB)throw Error("Total Rehab API base URL not set");let tE=(0,tS.createOpenApiClient)({baseURL:tB,onError:console.error});var tR=s(44267),tF=s(26495),tL=s(13524),tq=s(81743);let tM=(e,t)=>{let s=[];for(;e<=t;)s.push(new Date(e)),e.setDate(e.getDate()+1);return s},tU=e=>{var t;let{title:s,label:r,analyticsCountByDay:a}=e,{spacing:l,palette:n}=(0,eh.Z)();if(!a)return null;let o=a.map(e=>{let{day:t}=e;return new Date(t).getTime()}),c=new Date(Math.min.apply(null,o)),d=new Date(Math.max.apply(null,o)),x=tM(c,d);return(0,i.jsxs)(tD.Z,{sx:{marginTop:l(2),padding:l(2),margin:l(2),flex:1},children:[(0,i.jsx)(tZ.Z,{subheader:s}),(0,i.jsx)(tR.Z,{children:(0,i.jsx)(tF.x1,{height:300,datasetIdKey:"id",options:{maintainAspectRatio:!1,scales:{x:{ticks:{maxRotation:90,minRotation:90}}}},data:{labels:x.map(e=>(0,tL.Z)(e,"dd MMM")),datasets:[{label:r,borderColor:n.primary.main,backgroundColor:n.primary.main,data:x.map(e=>{var s;return null!==(t=null===(s=a.find(t=>(0,tq.Z)(new Date(t.day),e)))||void 0===s?void 0:s.count)&&void 0!==t?t:0})}]}})})]})};tO.kL.register(tO.uw,tO.f$,tO.u,tO.De,tO.od,tO.jn);let tz=()=>{let{spacing:e}=(0,eh.Z)(),{data:t}=(0,tW.a)(["analytics"],()=>tE.getAnalytics());return(0,i.jsxs)(tD.Z,{sx:{marginTop:e(2),marginBottom:e(8)},children:[(0,i.jsx)(tZ.Z,{title:"Total Rehab Dashboard"}),(0,i.jsxs)(ej.Z,{sx:{display:"flex",flexDirection:{xs:"column",lg:"row"}},children:[(0,i.jsx)(tU,{title:"New users by day",label:"New users",analyticsCountByDay:null==t?void 0:t.newUsersByDay}),(0,i.jsx)(tU,{title:"Active users by day",label:"Active users",analyticsCountByDay:null==t?void 0:t.activeUsersByDay})]}),(0,i.jsxs)(ej.Z,{sx:{display:"flex",flexDirection:{xs:"column",lg:"row"}},children:[(0,i.jsx)(tU,{title:"Programs started by day",label:"Programs started",analyticsCountByDay:null==t?void 0:t.programsStartedByDay}),(0,i.jsx)(tU,{title:"Completed tasks by day",label:"Completed tasks",analyticsCountByDay:null==t?void 0:t.completedTasksByDay})]})]})},tH=[(0,i.jsx)(D.o,{label:"Search by title",source:"q",alwaysOn:!0},"search")],tJ=()=>(0,i.jsx)(B.a,{actions:(0,i.jsx)(_,{hasFilters:!0}),perPage:25,filters:tH,children:(0,i.jsxs)(E.c,{rowClick:"edit",children:[(0,i.jsx)(R.n,{source:"title"}),(0,i.jsx)(F.N,{source:"createdAt",textAlign:"center",showTime:!0}),(0,i.jsx)(F.N,{source:"updatedAt",textAlign:"center",showTime:!0}),(0,i.jsx)(R.n,{source:"id",textAlign:"center"})]})}),t_=()=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(D.o,{source:"title",validate:[(0,Z.C1)()],fullWidth:!0}),(0,i.jsxs)(em,{children:[(0,i.jsx)(P.nW,{source:"heroImageId",label:"Hero Image"}),(0,i.jsx)(P.nW,{source:"thumbnailImageId",label:"Thumbnail Image"})]}),(0,i.jsx)(eK,{source:"content",fullWidth:!0})]}),tG=()=>(0,i.jsx)(k.ck,{children:(0,i.jsx)(t_,{})}),tK=()=>(0,i.jsx)(k.Py,{children:(0,i.jsx)(t_,{})}),tY=[(0,i.jsx)(D.o,{label:"Search by title",source:"q",alwaysOn:!0},"search")],tV=()=>(0,i.jsx)(B.a,{actions:(0,i.jsx)(_,{hasFilters:!0}),perPage:25,filters:tY,children:(0,i.jsxs)(E.c,{rowClick:"edit",children:[(0,i.jsx)(R.n,{source:"title"}),(0,i.jsx)(F.N,{source:"createdAt",textAlign:"center",showTime:!0}),(0,i.jsx)(F.N,{source:"updatedAt",textAlign:"center",showTime:!0}),(0,i.jsx)(R.n,{source:"id",textAlign:"center"})]})}),tX=()=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(D.o,{source:"title",validate:[(0,Z.C1)()],fullWidth:!0}),(0,i.jsxs)(em,{children:[(0,i.jsx)(P.nW,{source:"heroImageId",label:"Hero Image"}),(0,i.jsx)(P.nW,{source:"thumbnailImageId",label:"Thumbnail Image"})]}),(0,i.jsx)(eK,{source:"content",fullWidth:!0})]}),tQ=()=>(0,i.jsx)(k.ck,{children:(0,i.jsx)(tX,{})}),t$=()=>(0,i.jsx)(k.Py,{children:(0,i.jsx)(tX,{})});var t0=s(19070);let t1=e9(),t2=(0,T.I)(t1),t5=new URL("/settings","https://api.total-rehab.co.uk").href,t6=()=>{let[e,t]=(0,Y.useState)(),s=(0,tA.d)(),{spacing:r}=(0,eh.Z)(),a=(0,Y.useCallback)(async()=>{let e=await t2(t5);t(await e.json())},[]),l=(0,Y.useCallback)(async e=>{try{await t2(t5,{method:"PUT",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}})}catch(t){console.error(t),s("Settings update failed",{type:"error"});return}s("Settings updated",{type:"success"})},[s]);return((0,Y.useEffect)(()=>{a()},[a]),e)?(0,i.jsx)(t0.N,{record:e,onSubmit:l,sx:{gap:100},children:(0,i.jsxs)("div",{style:{gap:r(4),width:"100%",display:"flex",flexDirection:"column"},children:[(0,i.jsx)(eT.Y,{fullWidth:!0,validate:(0,Z.C1)(),source:"freeDays",helperText:"The number of days a user can complete before subscribing"}),(0,i.jsx)(eT.Y,{fullWidth:!0,validate:(0,Z.C1)(),source:"reviewDay",helperText:"The day that a request to leave a review is shown"}),(0,i.jsx)(D.o,{fullWidth:!0,validate:(0,Z.C1)(),source:"remindersMessage",helperText:"The body of the scheduled reminder message"}),(0,i.jsx)(eK,{source:"termsAndConditions",fullWidth:!0}),(0,i.jsx)(eK,{source:"privacyPolicy",fullWidth:!0}),(0,i.jsx)(eK,{source:"citations",fullWidth:!0})]})}):null};var t4=s(55678);s(64213);let t3=()=>{let e=(0,tI.J)(),t=()=>{var t;let s=null!==(t="".concat("https://api.total-rehab.co.uk","/subscription/generateDeepLink"))&&void 0!==t?t:"https://bc0b-119-155-29-70.ngrok-free.app/subscription/generateDeepLink";fetch(s,{method:"GET",headers:{"ngrok-skip-browser-warning":"true"}}).then(e=>{if(!e.ok)throw Error("Request failed with status: ".concat(e.status));return e.json()}).then(t=>{console.log(t),e(),(0,t4.Am)("New Deeplink Generated")}).catch(e=>{console.error("Error:",e)})};return(0,i.jsxs)(B.a,{actions:(0,i.jsx)(H.z,{variant:"contained",style:{margin:"20px 20px 20px 20px"},onClick:()=>t(),children:(0,i.jsx)("span",{children:" Generate Deeplink "})}),perPage:25,children:[(0,i.jsxs)(E.c,{bulkActionButtons:!1,children:[(0,i.jsx)(R.n,{source:"id",textAlign:"center"}),(0,i.jsx)(R.n,{source:"url",textAlign:"center"}),(0,i.jsx)(R.n,{source:"status",textAlign:"center"})]}),(0,i.jsx)(t4.Ix,{position:"bottom-right",autoClose:5e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light"})]})},t9=e9(),t7=(0,T.I)(t9),t8=(0,N.d8)("https://api.total-rehab.co.uk",{fetch:t7});console.log(t8,"DataProvider");let se=(0,d.Sy)(t9,{acceptedRoles:["ADMIN"],getIdentity:async e=>{var t;let{data:s,error:r}=await t9.from("User").select("name, role").eq("guid",e.id),{name:i,role:a}=null!==(t=null==s?void 0:s[0])&&void 0!==t?t:{},{id:l,email:n}=e;return{id:l,fullName:null!=i?i:n,email:n,role:a}}}),st=()=>((0,a.j)(),(0,i.jsxs)(l.v,{children:[(0,i.jsx)(l.v,{}),(0,i.jsx)(l.v.Item,{to:"/settings",primaryText:"Settings",leftIcon:(0,i.jsx)(y.Z,{})})]})),ss=async e=>{let t={};if(!(0,N.o0)(e))throw e;return e.errors?e.errors.reduce((e,t)=>({...e,[t.property]:(0,C.G)(t.message)}),t):t},sr=e=>{let{appEnv:t}=e;return(0,i.jsx)(P.oE,{croppable:!0,convertFileName:!0,supabase:t9,resource:"media",bucket:"images",bucketFolder:"public",accept:["image/*","video/*"],maxSize:"production"===t?1e9:5e7,aspectRatio:"3 / 2",sort:{field:"createdAt",order:"DESC"},resizeOptions:{maxSizeMB:1,maxWidthOrHeight:1920},children:(0,i.jsx)(k.RV,{onError:ss,children:(0,i.jsxs)(n.w,{basename:"/admin",theme:te,dataProvider:t8,authProvider:se,layout:es,dashboard:tz,loginPage:(0,i.jsx)(d.Xs,{background:e8}),menu:st,children:[(0,i.jsx)(o._,{name:"subscription/getAllDeepLink",options:{label:"Deep links"},list:t3,icon:A.Z}),(0,i.jsx)(o._,{name:"programs",list:ew,create:eX,edit:e$,show:e4,icon:p.Z}),(0,i.jsx)(o._,{name:"tasks",list:tl,create:tc,edit:td,icon:j.Z}),(0,i.jsx)(o._,{name:"activities",list:ec,create:eg,edit:ev,icon:h.Z}),(0,i.jsx)(o._,{name:"modalities",list:K,create:O,edit:S,icon:w.Z}),(0,i.jsx)(o._,{name:"equipment",list:K,create:O,edit:S,icon:u.Z}),(0,i.jsx)(o._,{name:"phases",list:K,create:O,edit:S,icon:m.Z}),(0,i.jsx)(o._,{name:"media",options:{label:"Media Library"},list:tt,create:tr,edit:ti,icon:g.Z}),(0,i.jsx)(o._,{name:"guides",list:tg,create:tb,edit:ty,icon:v.Z}),(0,i.jsx)(o._,{name:"blog-posts",options:{label:"Blog Posts"},list:tJ,create:tG,edit:tK,icon:b.Z}),(0,i.jsx)(o._,{name:"plans",list:tV,create:tQ,edit:t$,icon:f.Z}),(0,i.jsx)(o._,{name:"users",list:tx,edit:tm,create:tf,icon:I.Z}),(0,i.jsxs)(c.G,{children:[(0,i.jsx)(x.AW,{path:"/bulk-create/tasks",element:(0,i.jsx)(tN,{})}),(0,i.jsx)(x.AW,{path:"/settings",element:(0,i.jsx)(t6,{})})]})]})})})};var si=sr},24654:function(){}}]);